# 6章:ステート管理
個人メモ付き

- Reactコンポーネントが持つデータ
  - プロパティ
    - Read Only
  - ステート(State)
    - 描画後に変更されるデータ
  
- 6.1 StartRatingコンポーネント
  - 食べログのような，評価を星で表示するサイト
  - 6.1参照 
    - $ npx create-react-app my-project で作成
      - webpack設定などは追加する必要がある
  - FaStarを使おう
    - 6.1.1 useStateフックを使ってクリックイベントに対応する
      - starは描画後に変化するので：ステート
        - フック(Hook)：関数コンポーネントでステートを使う時に使用する
      - useStateフック
        - ステートの初期値を受け取って配列を返す
    - 6.1.2 再利用性を考慮したリファクタリング
      - CSSを使う場合は，styleプロパティを経由する
      - 実際は，propに入る値の不正確認は実施すべき
        - 今回はしていない

- 6.2 App全体のステート
  - ステート値をどのように保持・伝播させるか？ について
  - 個々がステートを持つのは△ 
    - 管理が大変
    - 可能なら，rootなどで一元管理したい
  - 6.2.1 ステート値をコンポーネントツリーの上から下に伝える
    - rootコンポーネントのみでuseStateする実装例
    - 上位(App)から下へ実装していく
  - 6.2.2 ユーザの操作をコンポーネントツリーの下から上に伝える
    - 色の情報をどうやって伝えるか？
      - 実装例
        - ステート更新処理は，ある種void関数を用意しているのと同じかもしれない． ただ，返り値は必要なので，f=>fと仮置きしている

- 6.3 Form入力を処理するApp
  - 6.3.1 refを使ったデータアクセス
    - refを使うとDOMノードに直接アクセスできる
      - useRefフックを使ってみよう
        - △使い方に注意． uncontrolled componentになる可能性がある
        - 推奨ではなさそう
  - 6.3.2 制御されたコンポーネント
    - controlled component:Reactが管理できる
      - useRef→useStateに変更してみよう
        - パフォーマンス改善の余地あり
  - 6.3.3 カスタムフック
    - 共通処理の切り出しなどができる
  - 6.3.4 入力をステート値に反映させる
    - rootコンポーネントの定義
      - 色見本Appの完成
  
- 6.4 Reactコンテキスト
  - ファイル階層が複雑になり，ネストが深くなるにつれて6.3は厳しい
    - 中間層のファイルに，データを受け継ぐ処理が膨大に書かれる可能性がある
    - コンテキストの利用
      - 空港のようなもの
        - スポットにピンポイントに飛べる
      - コンテキストプロバイダーにデータを渡し
      - コンテキストコンシューマーによってデータを読み出す
  - 6.4.1 コンテキスト経由でデータを公開する
    - 実装例
    - ContextProviderの使用
  - 6.4.2 useContextフックからデータを取得する
    - データを取り出すときはuseContextフックを使用する
  - 6.4.3 コンテキストとステートの併用
    - プロバイダーを使用するとデータ公開は可能だが，変更は難しい
      - カスタムプロバイダーの使用
    - カスタムプロバイダー：ステートを保持するコンポーネントでコンテキストプロバイダーを描画する場合
  - 6.4.4 コンテキストとカスタムフックの併用
    - Appのロジックをフックに切り分けることで，「関心の分離」が促進されて良い